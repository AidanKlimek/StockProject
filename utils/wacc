import yfinance as yf
import pandas as pd

def get_market_return(ticker, start_date, end_date):
    """
    Fetches historical market data for the given ticker (e.g., S&P 500) and calculates the annualized return.
    
    Parameters:
    - ticker: str, the ticker symbol for the market index (e.g., "^GSPC" for S&P 500)
    - start_date: str, the start date for the data (format: "YYYY-MM-DD")
    - end_date: str, the end date for the data (format: "YYYY-MM-DD")
    
    Returns:
    - annualized_return: float, the calculated annualized market return
    """
    # Retrieve market data
    market = yf.Ticker(ticker)
    data = market.history(start=start_date, end=end_date)
    
    # Calculate the total return over the period (including dividends)
    total_return = (data['Close'][-1] / data['Close'][0]) - 1
    
    # Approximate annualized return based on 252 trading days per year
    annualized_return = ((1 + total_return) ** (1 / (len(data) / 252))) - 1
    return annualized_return

# Example usage:
ticker = "^GSPC"  # S&P 500 index ticker on Yahoo Finance
start_date = "2013-01-01"  # Start date for the historical data
end_date = "2023-01-01"    # End date for the historical data

# Get the market return
market_return = get_market_return(ticker, start_date, end_date)


def get_risk_free_rate(ticker="^TNX"):
    """
    Fetches the latest risk-free rate (10-year U.S. Treasury yield) from Yahoo Finance.
    
    Parameters:
    - ticker: str, the ticker symbol for the 10-year U.S. Treasury bond yield (default: "^IRX" for 13-week Treasury yield)
    
    Returns:
    - risk_free_rate: float, the latest risk-free rate
    """
    # Retrieve data for the 10-year Treasury yield
    treasury = yf.Ticker(ticker)
    data = treasury.history(period="1d")
    
    # The risk-free rate is the last closing price of the Treasury bond
    risk_free_rate = data['Close'].iloc[-1] / 100  # Convert from basis points to percentage
    return risk_free_rate

# Example usage
risk_free_rate = get_risk_free_rate(ticker="^TNX")  # You can replace with "^TNX" for 10-year Treasury yield



print(f"Risk-Free Rate: {risk_free_rate:.4f}")
print(f"Market return for {ticker} from {start_date} to {end_date}: {market_return:.4f}")